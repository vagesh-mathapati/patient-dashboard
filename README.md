[![Build](https://github.com/vagesh-mathapati/patient-dashboard/actions/workflows/build-maven.yaml/badge.svg)](https://github.com/Solutions-and-Technology/admin-service/actions/workflows/build.yaml)

# patient-dashboard
Patient Dashboard is K8S based microservice application which is used to analyze patients data and provide insights to the user.
This is multi-tenanted application where each tenant (referred as hospital) can have multiple patients. Each user based on role 
can view the details of patients and view the insights generated by the application.

## Features
### Current available Features
- Multi-tenanted application
- Patient data analysis
- Cohorts management
- Report generation from saved Cohorts
- All data can be accessed through APIs

### Future Features
- View reports using UI

## Solutions

### Current
- SpringBoot based Java 17 application
- Liquibase managed schema
- JPA Hibernate to pull data from PostgreSQL
- Views to fetch data from DB using JPA
- Hikari Connection pool
- Indexes on tables for faster data retrieval
- OpenAPIs
- Boilerplate code for API documentation
- Swagger for API documentation
- Centralized Exception handling
- Console Logging to debug issues
- Junit5 for unit testing
- Sample SQL script to generate data for testing

### Working APIs
1. Paginated API to get patient details based on filter.

POST http://localhost:8080/v1/hospitals/1d831e1b-4d9f-4446-85d9-e05b2652557b/patients-details?pageSize=9000
RequestBody 
	{
  "age": {
    "operator": ">",
    "value": 30
  },
  "diagnosis": {
    "operator": "CONTAINS",
    "value": "Depression"
  } ,
  "lastVisitAfter": {
    "operator": "AFTER",
    "value": "2021-01-01"
  }
}

Response 200 OK with paginated data... Links can be used to get next or previous page details

2. Create Cohort

POST http://localhost:8080/v1/hospitals/1d831e1b-4d9f-4446-85d9-e05b2652557b/cohorts
{
  "name": "Diabetic Patients 50+",
  "filters": {
    "age": {
      "operator": ">",
      "value": 50
    },
    "diagnosis": {
      "operator": "CONTAINS",
      "value": "diabetes"
    },
    "lastVisitAfter": {
      "operator": "AFTER",
      "value": "2021-01-01"
    }
  }
}

Response 201 Created

3. Get Individual Cohort

GET http://localhost:8080/v1/hospitals/1d831e1b-4d9f-4446-85d9-e05b2652557b/cohorts/da2a0a77-a6e3-4a60-836d-270f061a8f1f

Response 200 OK with Cohort details

4. Execute saved Cohort 

POST http://localhost:8080/v1/hospitals/1d831e1b-4d9f-4446-85d9-e05b2652557b/cohorts/fb97eedc-4442-4a8c-8898-0dc987dc65c2:execute?pageSize=500 

Response 200 OK with paginated data... Links can be used to get next or previous page details

5. Get all saved Cohorts
GET http://localhost:8080/v1/hospitals/1d831e1b-4d9f-4446-85d9-e05b2652557b/cohorts

### Performance results

#### Test Data
1. Seed 4000 Patients data into DB.
2. Seed 50 Doctors data into DB.
3. Seed 40000 visits data into DB.
4. Single app running.

#### Test results
1. To get "Diabetic Patients 50+ Age " taking around ~70 ms
2. To get "Depression patients 30+ Age" taking around ~80 ms
3. To get all patients with visits details taking around ~70ms